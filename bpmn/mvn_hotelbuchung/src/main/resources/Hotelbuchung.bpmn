<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1phg2cc" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.7.1">
  <bpmn:collaboration id="Collaboration_1fkr7nk">
    <bpmn:participant id="Participant_reisebuero" name="Reisebüro" processRef="Hotelbuchung" />
    <bpmn:participant id="Participant_kunde" name="Kunde" />
  </bpmn:collaboration>
  <bpmn:process id="Hotelbuchung" isExecutable="true">
    <bpmn:laneSet id="LaneSet_1rvvgjs">
      <bpmn:lane id="Lane_filialleiter" name="Filialleiter">
        <bpmn:flowNodeRef>XOR_ratenzahlungGenehmigt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ratenzahlungPruefen</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_servicemitarbeiter" name="Servicemitarbeiter">
        <bpmn:flowNodeRef>XOR_bonitaetVorhanden</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ratenzahlungAnbieten</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_ratenzahlungZugestimmt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_sofortzahlungAnbieten</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_sofortzahlungZugestimmt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_zahlungsweiseAuswaehlen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_angebotZugestimmt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_ZahlungsweiseAusgewaehlt</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_buchungAbgebrochen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_buchungAbgebrochen2</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_kundendatenAufnehmen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_sofortzahlungDurchfuehren</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_bankdatenEinholen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_kundenwunschVerfuegbar</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_kundenwunschErfassen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_verfuegbarkeitenPruefen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_angebotAuswaehlen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>StartEvent_buchungswunschLiegtVor</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_1nub4bv</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_0zjevc8</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_kundenwunschAnpassen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_problemBesprechen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_0dy0a97</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_16mvpmg</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_bonitaetPruefen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_rechnungGenerieren</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_lastschrifterlaubnisEinholen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_0epjd7p</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_kundenInformieren</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>ExclusiveGateway_0g8vq52</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_reisebuchungDurchfuehren</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_ReiseVerbindlichBuchen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_0lwg6xz</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_1ho2gme</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_unterlagenUebergeben</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_buchungAbgeschlossen</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>XOR_LastschrifteinzugOK</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:exclusiveGateway id="XOR_bonitaetVorhanden" name="Bonität vorhanden?">
      <bpmn:incoming>SequenceFlow_1hlkcca</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1ar5dxc</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0p3k10m</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_ratenzahlungAnbieten" name="Ratenzahlung anbieten">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="rA_bonitaet" label="Ergebnis der Bonitätsprüfung:" type="string" defaultValue="${bP_bonitaet}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rA_ratenzahlung" label="Ratenzahlung gewünscht?" type="enum">
            <camunda:value id="true" name="Ja, Ratenzahlung." />
            <camunda:value id="false" name="Nein, keine Ratenzahlung." />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0p3k10m</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_030o4sl</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="XOR_ratenzahlungZugestimmt" name="Ratenzahlung zugestimmt?">
      <bpmn:incoming>SequenceFlow_030o4sl</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1h399qt</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0n9prht</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_sofortzahlungAnbieten" name="Sofortzahlung anbieten">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="sA_bonitaet" label="Ergebnis der Bonitätsprüfung:" type="string" defaultValue="${bP_bonitaet}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="sA_sofortzahlung" label="Sofortzahlung oder Vorgang abbrechen?" type="enum">
            <camunda:value id="true" name="Sofort bezahlen!" />
            <camunda:value id="false" name="Vorgang abbrechen!" />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1ar5dxc</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1mz5q3s</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="XOR_sofortzahlungZugestimmt" name="Sofortzahlung zugestimmt?">
      <bpmn:incoming>SequenceFlow_1mz5q3s</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1ib12rw</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_091jvlm</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="XOR_ratenzahlungGenehmigt" name="Ratenzahlung genemigt?">
      <bpmn:incoming>SequenceFlow_0gmrw1v</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_09zsf56</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_09jw7d1</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_zahlungsweiseAuswaehlen" name="Zahlungsweise auswählen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="zA_auswahlZahlungsweise" label="Zahlungsweise auswählen:" type="enum">
            <camunda:value id="sofort" name="Sofort bezahlen!" />
            <camunda:value id="aufZiel" name="Auf Ziel bezahlen!" />
            <camunda:value id="abbruch" name="Vorgang abbrechen!" />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0n9prht</bpmn:incoming>
      <bpmn:incoming>Flow_0ddtrac</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0ljyxsw</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Task_ratenzahlungPruefen" name="Ratenzahlung prüfen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="rP_anrede" label="Anrede:" type="string" defaultValue="${kA_anrede}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_vorname" label="Vorname:" type="string" defaultValue="${kA_vorname}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_nachname" label="Nachname:" type="string" defaultValue="${kA_nachname}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_geburtsdatum" label="Geburtsdatum:" type="string" defaultValue="${kA_geburtsdatum}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_eMail" label="E-Mail-Adresse:" type="string" defaultValue="${kA_eMail}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_strasse" label="Straße:" type="string" defaultValue="${kA_strasse}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_hausnummer" label="Hausnummer:" type="string" defaultValue="${kA_hausnummer}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_plz" label="PLZ:" type="string" defaultValue="${kA_plz}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_ort" label="Ort:" type="string" defaultValue="${kA_ort}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_umzugLetzten12Monate" label="Umzug innerhalb der letrzten 12 Monate?" type="string" defaultValue="${kA_umzugLetzten12Monate}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_bonitaet" label="Ergebnis der Bonitätsprüfung:" type="string" defaultValue="${bP_bonitaet}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="rP_ratenzahlungPruefung" label="Zahlung in Raten genehmigt?" type="boolean" />
          <camunda:formField id="rP_kommentarZurRatenzahlung" label="Kommentar zur Genehmiguing bzw. Ablehnung:" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1h399qt</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0gmrw1v</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="XOR_angebotZugestimmt" name="Angebot zugestimmt?">
      <bpmn:incoming>Flow_1474zut</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1o47qu8</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0ixeut4</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1omvrja</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="XOR_ZahlungsweiseAusgewaehlt" name="Zahlungsweise ausgewählt?">
      <bpmn:incoming>SequenceFlow_0ljyxsw</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_01qftwm</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1hbqqii</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_11bgnag</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="EndEvent_buchungAbgebrochen" name="Buchung abgebrochen">
      <bpmn:incoming>SequenceFlow_00vat3d</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1omvrja</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndEvent_buchungAbgebrochen2" name="Buchung abgebrochen">
      <bpmn:incoming>SequenceFlow_091jvlm</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_11bgnag</bpmn:incoming>
      <bpmn:incoming>Flow_0xzbv90</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:userTask id="Task_kundendatenAufnehmen" name="Kundendaten aufnehmen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="kA_anrede" label="Anrede:" type="enum">
            <camunda:value id="Herr" name="Herr" />
            <camunda:value id="Frau" name="Frau" />
          </camunda:formField>
          <camunda:formField id="kA_vorname" label="Vorname:" type="string" defaultValue="Jens" />
          <camunda:formField id="kA_nachname" label="Nachname:" type="string" defaultValue="Tester" />
          <camunda:formField id="kA_geburtsdatum" label="Geburtsdatum:" type="date" defaultValue="12/12/1984" />
          <camunda:formField id="kA_eMail" label="E-Mail-Adresse (für Rechnungsversand):" type="string" defaultValue="tester@testnix.de" />
          <camunda:formField id="kA_strasse" label="Straße:" type="string" defaultValue="xyzstraße" />
          <camunda:formField id="kA_hausnummer" label="Hausnummer:" type="string" defaultValue="13A" />
          <camunda:formField id="kA_plz" label="PLZ:" type="string" defaultValue="23455" />
          <camunda:formField id="kA_ort" label="Ort:" type="string" defaultValue="Ortnix" />
          <camunda:formField id="kA_umzugLetzten12Monate" label="Sind Sie in den letzten 12 Monaten umgezogen?" type="boolean" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1o47qu8</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1fljneq</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Task_sofortzahlungDurchfuehren" name="Sofortzahlung durchführen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="sD_ecKarteKreditKarteBar" label="Wie möchten Sie zahlen? EC-, Kreditkarte oder bar?" type="enum">
            <camunda:value id="ecKarte" name="EC-Karte!" />
            <camunda:value id="kreditKarte" name="Kreditkarte!" />
            <camunda:value id="barZahlen" name="Bar bezahlen!" />
          </camunda:formField>
          <camunda:formField id="sD_bestaetigungGeldErhalten" label="Verkäufer bestätigt Erhalt des Geldes!" type="boolean" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1ib12rw</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1hbqqii</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_12zwqq9</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Task_bankdatenEinholen" name="Bankdaten einholen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="bE_anrede" label="Anrede:" type="string" defaultValue="${kA_anrede}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_vorname" label="Vorname:" type="string" defaultValue="${kA_vorname}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_nachname" label="Nachname:" type="string" defaultValue="${kA_nachname}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_geburtsdatum" label="Geburtsdatum:" type="string" defaultValue="${kA_geburtsdatum}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_eMail" label="E-Mail-Adresse:" type="string" defaultValue="${kA_eMail}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_strasse" label="Straße:" type="string" defaultValue="${kA_strasse}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_hausnummer" label="Hausnummer:" type="string" defaultValue="${kA_hausnummer}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_plz" label="PLZ:" type="string" defaultValue="${kA_plz}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_ort" label="Ort:" type="string" defaultValue="${kA_ort}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_umzugLetzten12Monate" label="Umzug innerhalb der letrzten 12 Monate?" type="string" defaultValue="${kA_umzugLetzten12Monate}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_bonitaet" label="Ergebnis der Bonitätsprüfung:" type="string" defaultValue="${bP_bonitaet}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_ratenzahlungPruefung" label="Zahlung in Raten genehmigt?" type="string" defaultValue="${rP_ratenzahlungPruefung}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_kommentarZurRatenzahlung" label="Kommentar zur Genehmiguing bzw. Ablehnung:" type="string" defaultValue="${rP_kommentarZurRatenzahlung}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="bE_bankISBN" label="ISBN erfassen:" type="string" />
          <camunda:formField id="bE_bankInstitut" label="Bankinstitut erfassen:" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_09zsf56</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0jzxq8u</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="XOR_kundenwunschVerfuegbar" name="Kundenwunsch verfügbar?">
      <bpmn:incoming>SequenceFlow_1em2555</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1jkbexr</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_059rxai</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_kundenwunschErfassen" name="Kundenwunsch erfassen" camunda:formKey="embedded:app:forms/kundenwunschErfassen.html">
      <bpmn:incoming>SequenceFlow_14bnl9k</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_0ixeut4</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_0ghvr2o</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0dbxllw</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:scriptTask id="Task_verfuegbarkeitenPruefen" name="Verfügbarkeiten prüfen" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_0dbxllw</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1em2555</bpmn:outgoing>
      <bpmn:script>import groovy.json.JsonSlurper

// Input
def guests = execution.getVariable("kE_anzPersonen")
def arrival = Date.parse("dd.MM.yyyy", execution.getVariable("kE_anreisedatum"))
def depart = Date.parse("dd.MM.yyyy", execution.getVariable("kE_abreisedatum"))
def city = execution.getVariable("kE_stadtAuswahl")
def hotelid = execution.getVariable("kE_hotelAuswahl")
def nights = depart - arrival

enum RoomTypes {
    SINGLE, DOUBLE, SUITE
}

// Prepare
def rooms = getServiceReponse(city+'/'+hotelid+'/rooms')
def hotelname = getServiceReponse(city+"/"+hotelid).name
def availableRoomsByType = [:]
def fittingRooms = []
def errorRooms = [:]
def price = 0

// Look for fitting rooms
for (type in RoomTypes) {
    // Get all free rooms by type
    typeAvailableRooms = getFreeRooms(rooms, type.name().toLowerCase())
    // Let's save them for later
    availableRoomsByType[type] = typeAvailableRooms
    // Ok, how many do we need from this type
    typeAmount = getRequestedRoomAmount(type)
    // Choose rooms for offer
    if (typeAvailableRooms.size() &gt;= typeAmount) {
        for (i = 0; i &lt; typeAmount; i++) {
            def roomNumber = typeAvailableRooms[i].get('number')
            def roomPrice = typeAvailableRooms[i].get('price')
            // Lock rooms
            updateRoomInfo(city+'/'+hotelid+'/rooms/'+roomNumber, '{"status": "locked", "bookedfrom": "'+arrival.format("dd.MM.yyyy")+'", "bookeduntil": "'+depart.format("dd.MM.yyyy")+'"}')
            // Save room number and calc price
            fittingRooms.add(roomNumber)
            price += nights * roomPrice
        }
    } else {
        // Note how many are missing from this type
        errorRooms[type] = (typeAmount - typeAvailableRooms.size())
    }
}

// Output
if (errorRooms.size() == 0) {
    def priceSingle = (availableRoomsByType[RoomTypes.SINGLE][0] != null) ? availableRoomsByType[RoomTypes.SINGLE][0]['price'] : 0
    def priceDouble = (availableRoomsByType[RoomTypes.DOUBLE][0] != null) ? availableRoomsByType[RoomTypes.DOUBLE][0]['price'] : 0
    def priceSuite = (availableRoomsByType[RoomTypes.SUITE][0] != null) ? availableRoomsByType[RoomTypes.SUITE][0]['price'] : 0
    execution.setVariable("vP_verfuegbarkeit", true)
    execution.setVariable("vP_preisEinzelzimmer", priceSingle)
    execution.setVariable("vP_preisDoppelzimmer", priceDouble)
    execution.setVariable("vP_preisSuiten", priceSuite)
    execution.setVariable("vP_preisReiseGesamt", price)
    execution.setVariable("vP_blockierteRaeume", fittingRooms.join(","))
    execution.setVariable("vP_nameHotel", hotelname)
} else {
    def missingSingle = (errorRooms[RoomTypes.SINGLE] != null) ? errorRooms[RoomTypes.SINGLE] : 0
    def missingDouble = (errorRooms[RoomTypes.DOUBLE] != null) ? errorRooms[RoomTypes.DOUBLE] : 0
    def missingSuite = (errorRooms[RoomTypes.SUITE] != null) ? errorRooms[RoomTypes.SUITE] : 0
    execution.setVariable("vP_verfuegbarkeit", false)
    execution.setVariable("vP_anzFehlenderEinzelzimmer", missingSingle)
    execution.setVariable("vP_anzFehlenderDoppelzimmerzimmer", missingDouble)
    execution.setVariable("vP_anzFehlenderSuiten", missingSuite)
}

/**
* Make a call to the rooms service api.
* @param route the route to call
* @return the response of the service api
*/
def getServiceReponse(route) {
    def connection = new URL('http://implproz.cbu.net:8007/hotels/'+route).openConnection();
    def response = '';
    if(connection.getResponseCode().equals(200)) {
        response = connection.getInputStream().getText()
    }
    return new JsonSlurper().parseText(response)
} 
/**
* Change a room's infos
* @param route the route to call
* @param data json of data to change
*/
def updateRoomInfo(route, data) {
    def connection = new URL('http://implproz.cbu.net:8007/hotels/'+route).openConnection();
    connection.setRequestMethod("PUT")
    connection.setDoOutput(true)
    connection.setRequestProperty("Content-Type", "application/json")
    connection.getOutputStream().write(data.getBytes("UTF-8"))
    if(connection.getResponseCode().equals(200)) {
        println(connection.getInputStream().getText())
    }
    return
}

// TODO: Include a date check! Might have to adjust API
/**
* Get all free rooms of type
* @param rooms array of all rooms from api
* @param type type of room to look for
* @return all free rooms of type
*/
def getFreeRooms(rooms, type) {
    freeRooms = []
    rooms.each { roomNumber, roomInfo -&gt; 
        if (roomInfo.status == 'free' &amp;&amp; roomInfo.roomtype == type) {
            roomInfo['number'] = roomNumber
            freeRooms.add(roomInfo)
        }
    }
    return freeRooms
}

/**
* Get requested amount of room type
* @param type room type
* @return number of rooms requested
*/
def getRequestedRoomAmount(type) {
    switch (type) {
        case RoomTypes.SINGLE:
            return execution.getVariable("kE_anzEinzelzimmer")
            break
        case RoomTypes.DOUBLE:
            return execution.getVariable("kE_anzDoppelzimmer")
            break
        case RoomTypes.SUITE:
            return execution.getVariable("kE_anzSuite")
            break
        default:
            return 0
            break
    }
}</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:userTask id="Task_angebotAuswaehlen" name="Angebot auswählen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="aA_verfuegbarkeit" label="Ergebnis Verfügbarkeitsprüfung:" type="string" defaultValue="${vP_verfuegbarkeit}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_anreisedatum" label="Reisebeginn (Datum der Anreise):" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_abreisedatum" label="Reiseende (Datum der Abreise):" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_stadtAuswahl" label="Reiseort:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_nameHotel" label="Hotel-Name:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_blockierteRaeume" label="Vorgemerkte Räume:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_preisEinzelzimmer" label="Preis Einzelzimmer (pro Nacht):" type="long">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_preisDoppelzimmer" label="Preis Doppelzimmer (pro Nacht):" type="long">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_preisSuiten" label="Preis Suiten / Appartments (pro Nacht):" type="long">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="vP_preisReiseGesamt" label="Gesamtpreis der Reise:" type="long">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="aA_entscheidung" label="Entscheidung zum Angebot?" type="enum">
            <camunda:value id="annehmen" name="Angebot annehmen!" />
            <camunda:value id="abbruch" name="Vorgang abbrechen!" />
            <camunda:value id="aendern" name="Kundenwunsch ändern!" />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1jkbexr</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1t55m76</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:startEvent id="StartEvent_buchungswunschLiegtVor" name="Buchungswunsch liegt vor">
      <bpmn:outgoing>SequenceFlow_14bnl9k</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:exclusiveGateway id="Gateway_1nub4bv" name="Räume entsperren?">
      <bpmn:incoming>SequenceFlow_1t55m76</bpmn:incoming>
      <bpmn:outgoing>Flow_0qxhlzo</bpmn:outgoing>
      <bpmn:outgoing>Flow_1lt4o01</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="Gateway_0zjevc8">
      <bpmn:incoming>Flow_0qxhlzo</bpmn:incoming>
      <bpmn:incoming>Flow_03sig6a</bpmn:incoming>
      <bpmn:outgoing>Flow_1474zut</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="XOR_kundenwunschAnpassen" name="Kundenwunsch anpassen?">
      <bpmn:incoming>SequenceFlow_02kf837</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0ghvr2o</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_00vat3d</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_problemBesprechen" name="Problem besprechen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="vP_verfuegbarkeit" label="Ergebnis Verfügbarkeitsprüfung:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_anzEinzelzimmer" label="Anzahl der gewünschten Einzelzimmer:" type="string" />
          <camunda:formField id="vP_anzFehlenderEinzelzimmer" label="Fehlende Einzelzimmer:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_anzDoppelzimmer" label="Anzahl der gewünschten Doppelzimmer:" type="string" />
          <camunda:formField id="vP_anzFehlenderDoppelzimmerzimmer" label="Fehlende Doppelzimmerzimmer:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kE_anzSuite" label="Anzahl der gewünschten Suiten/ Appartments:" type="string" />
          <camunda:formField id="vP_anzFehlenderSuiten" label="Fehlende Suiten/ Appartments:" type="string">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="pB_entscheidung" label="Entscheidung: Kundenwunsch ändern oder Vorgang abbrechen?" type="enum">
            <camunda:value id="abbruch" name="Vorgang abbrechen!" />
            <camunda:value id="aendern" name="Kundenwunsch ändern!" />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_059rxai</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_02kf837</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="SequenceFlow_0jzxq8u" sourceRef="Task_bankdatenEinholen" targetRef="Task_lastschrifterlaubnisEinholen" />
    <bpmn:sequenceFlow id="SequenceFlow_01qftwm" name="Auf Ziel" sourceRef="XOR_ZahlungsweiseAusgewaehlt" targetRef="ExclusiveGateway_0g8vq52">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${zA_auswahlZahlungsweise == "aufZiel"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1ts5ggp" sourceRef="Task_lastschrifterlaubnisEinholen" targetRef="XOR_LastschrifteinzugOK" />
    <bpmn:sequenceFlow id="SequenceFlow_12zwqq9" sourceRef="Task_sofortzahlungDurchfuehren" targetRef="ExclusiveGateway_0g8vq52" />
    <bpmn:sequenceFlow id="SequenceFlow_1hbqqii" name="Sofort" sourceRef="XOR_ZahlungsweiseAusgewaehlt" targetRef="Task_sofortzahlungDurchfuehren">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${zA_auswahlZahlungsweise == "sofort"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_11bgnag" name="Abgebrochen" sourceRef="XOR_ZahlungsweiseAusgewaehlt" targetRef="EndEvent_buchungAbgebrochen2">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${zA_auswahlZahlungsweise == "abbruch"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_091jvlm" name="nein" sourceRef="XOR_sofortzahlungZugestimmt" targetRef="EndEvent_buchungAbgebrochen2">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${sA_sofortzahlung == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1ib12rw" name="ja" sourceRef="XOR_sofortzahlungZugestimmt" targetRef="Task_sofortzahlungDurchfuehren">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${sA_sofortzahlung == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0ljyxsw" sourceRef="Task_zahlungsweiseAuswaehlen" targetRef="XOR_ZahlungsweiseAusgewaehlt" />
    <bpmn:sequenceFlow id="SequenceFlow_1mkzrnu" sourceRef="Task_kundenInformieren" targetRef="Gateway_0epjd7p" />
    <bpmn:sequenceFlow id="SequenceFlow_09jw7d1" name="nein" sourceRef="XOR_ratenzahlungGenehmigt" targetRef="Task_kundenInformieren">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rP_ratenzahlungPruefung == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_09zsf56" name="ja" sourceRef="XOR_ratenzahlungGenehmigt" targetRef="Task_bankdatenEinholen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rP_ratenzahlungPruefung == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1mz5q3s" sourceRef="Task_sofortzahlungAnbieten" targetRef="XOR_sofortzahlungZugestimmt" />
    <bpmn:sequenceFlow id="SequenceFlow_0n9prht" name="nein" sourceRef="XOR_ratenzahlungZugestimmt" targetRef="Task_zahlungsweiseAuswaehlen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rA_ratenzahlung == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1h399qt" name="ja" sourceRef="XOR_ratenzahlungZugestimmt" targetRef="Task_ratenzahlungPruefen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rA_ratenzahlung == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0p3k10m" name="ja" sourceRef="XOR_bonitaetVorhanden" targetRef="Task_ratenzahlungAnbieten">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${bP_bonitaet == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_030o4sl" sourceRef="Task_ratenzahlungAnbieten" targetRef="XOR_ratenzahlungZugestimmt" />
    <bpmn:sequenceFlow id="SequenceFlow_1ar5dxc" name="nein" sourceRef="XOR_bonitaetVorhanden" targetRef="Task_sofortzahlungAnbieten">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${bP_bonitaet == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1hlkcca" sourceRef="Task_bonitaetPruefen" targetRef="XOR_bonitaetVorhanden" />
    <bpmn:sequenceFlow id="SequenceFlow_1fljneq" sourceRef="Task_kundendatenAufnehmen" targetRef="Task_bonitaetPruefen" />
    <bpmn:sequenceFlow id="SequenceFlow_1o47qu8" name="Angebot zugestimmt" sourceRef="XOR_angebotZugestimmt" targetRef="Task_kundendatenAufnehmen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aA_entscheidung == "annehmen"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0ixeut4" name="Änderung angefragt" sourceRef="XOR_angebotZugestimmt" targetRef="Task_kundenwunschErfassen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aA_entscheidung == "aendern"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1t55m76" sourceRef="Task_angebotAuswaehlen" targetRef="Gateway_1nub4bv" />
    <bpmn:sequenceFlow id="SequenceFlow_0gmrw1v" sourceRef="Task_ratenzahlungPruefen" targetRef="XOR_ratenzahlungGenehmigt" />
    <bpmn:sequenceFlow id="SequenceFlow_0b5ref0" sourceRef="ExclusiveGateway_0g8vq52" targetRef="Task_reisebuchungDurchfuehren" />
    <bpmn:sequenceFlow id="SequenceFlow_00vat3d" name="nein" sourceRef="XOR_kundenwunschAnpassen" targetRef="EndEvent_buchungAbgebrochen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${pB_entscheidung == abbruch}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1omvrja" name="Angebot abgebrochen" sourceRef="XOR_angebotZugestimmt" targetRef="EndEvent_buchungAbgebrochen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aA_entscheidung == "abbruch"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1em2555" sourceRef="Task_verfuegbarkeitenPruefen" targetRef="XOR_kundenwunschVerfuegbar" />
    <bpmn:sequenceFlow id="SequenceFlow_1jkbexr" name="ja" sourceRef="XOR_kundenwunschVerfuegbar" targetRef="Task_angebotAuswaehlen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${vP_verfuegbarkeit == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_059rxai" name="nein" sourceRef="XOR_kundenwunschVerfuegbar" targetRef="Task_problemBesprechen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${vP_verfuegbarkeit == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0ghvr2o" name="ja" sourceRef="XOR_kundenwunschAnpassen" targetRef="Task_kundenwunschErfassen">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${pB_entscheidung == aendern}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_14bnl9k" sourceRef="StartEvent_buchungswunschLiegtVor" targetRef="Task_kundenwunschErfassen" />
    <bpmn:sequenceFlow id="SequenceFlow_0dbxllw" sourceRef="Task_kundenwunschErfassen" targetRef="Task_verfuegbarkeitenPruefen" />
    <bpmn:sequenceFlow id="SequenceFlow_02kf837" sourceRef="Task_problemBesprechen" targetRef="XOR_kundenwunschAnpassen" />
    <bpmn:sequenceFlow id="Flow_0qxhlzo" name="nein" sourceRef="Gateway_1nub4bv" targetRef="Gateway_0zjevc8">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aA_entscheidung == "annehmen"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1474zut" sourceRef="Gateway_0zjevc8" targetRef="XOR_angebotZugestimmt" />
    <bpmn:sequenceFlow id="Flow_1lt4o01" name="ja" sourceRef="Gateway_1nub4bv" targetRef="Activity_0dy0a97">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aA_entscheidung != "annehmen"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_03sig6a" sourceRef="Activity_0dy0a97" targetRef="Gateway_0zjevc8" />
    <bpmn:scriptTask id="Activity_0dy0a97" name="Raumsperrung zurücksetzen" scriptFormat="groovy">
      <bpmn:incoming>Flow_1lt4o01</bpmn:incoming>
      <bpmn:outgoing>Flow_03sig6a</bpmn:outgoing>
      <bpmn:script>def lockedRooms = execution.getVariable("vP_blockierteRaeume")
def city = execution.getVariable("kE_stadtAuswahl")
def hotelid = execution.getVariable("kE_hotelAuswahl")
lockedRooms = lockedRooms.split(',')

for (roomNumber in lockedRooms) {
    // Unlock room
    updateRoomInfo(city+'/'+hotelid+'/rooms/'+roomNumber, '{"status": "free"}')
    println('Unlocked '+roomNumber)
}

/**
* Change a room's infos
* @param route the route to call
* @param data json of data to change
*/
def updateRoomInfo(route, data) {
    def connection = new URL('http://implproz.cbu.net:8007/hotels/'+route).openConnection();
    connection.setRequestMethod("PUT")
    connection.setDoOutput(true)
    connection.setRequestProperty("Content-Type", "application/json")
    connection.getOutputStream().write(data.getBytes("UTF-8"))
    if(connection.getResponseCode().equals(200)) {
        println(connection.getInputStream().getText())
    }
    return
}</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_0zty9hg" sourceRef="Gateway_0lwg6xz" targetRef="Task_rechnungGenerieren" />
    <bpmn:sequenceFlow id="Flow_1svdc1e" sourceRef="Task_rechnungGenerieren" targetRef="Gateway_1ho2gme" />
    <bpmn:sequenceFlow id="Flow_0lny208" sourceRef="Gateway_1ho2gme" targetRef="Task_unterlagenUebergeben" />
    <bpmn:sequenceFlow id="SequenceFlow_00j2no7" sourceRef="Task_unterlagenUebergeben" targetRef="EndEvent_buchungAbgeschlossen" />
    <bpmn:sequenceFlow id="Flow_1130rds" sourceRef="Gateway_0lwg6xz" targetRef="Activity_16mvpmg" />
    <bpmn:sequenceFlow id="Flow_00qj9j2" sourceRef="Activity_16mvpmg" targetRef="Gateway_1ho2gme" />
    <bpmn:sequenceFlow id="Flow_1vmfto9" sourceRef="Task_reisebuchungDurchfuehren" targetRef="XOR_ReiseVerbindlichBuchen" />
    <bpmn:sequenceFlow id="Flow_0xzbv90" sourceRef="XOR_ReiseVerbindlichBuchen" targetRef="EndEvent_buchungAbgebrochen2">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rD_buchungDurchfueren == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_16rhwpt" name="ja" sourceRef="XOR_ReiseVerbindlichBuchen" targetRef="Gateway_0lwg6xz">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${rD_buchungDurchfueren == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:scriptTask id="Activity_16mvpmg" name="Hotelbuchung durchführen" scriptFormat="groovy">
      <bpmn:incoming>Flow_1130rds</bpmn:incoming>
      <bpmn:outgoing>Flow_00qj9j2</bpmn:outgoing>
      <bpmn:script>def lockedRooms = execution.getVariable("vP_blockierteRaeume")
def city = execution.getVariable("kE_stadtAuswahl")
def hotelid = execution.getVariable("kE_hotelAuswahl")
def firstname = execution.getVariable("kA_vorname")
def lastname = execution.getVariable("kA_nachname")
def arrival = Date.parse("dd.MM.yyyy", execution.getVariable("kE_anreisedatum"))
def depart = Date.parse("dd.MM.yyyy", execution.getVariable("kE_abreisedatum"))
def bookingnr = execution.getVariable("bP_buchungsnummer")
lockedRooms = lockedRooms.split(',')

for (roomNumber in lockedRooms) {
    // Book room
    updateRoomInfo(city+'/'+hotelid+'/rooms/'+roomNumber, '{"status": "occupied", "guest": "'+firstname+' '+lastname+'" ,"bookedfrom": "'+arrival.getDateString()+'", "bookeduntil": "'+depart.getDateString()+'", "bookingnr": "'+bookingnr+'"}')
    println('Booked '+roomNumber)
}

/**
* Change a room's infos
* @param route the route to call
* @param data json of data to change
*/
def updateRoomInfo(route, data) {
    def connection = new URL('http://implproz.cbu.net:8007/hotels/'+route).openConnection();
    connection.setRequestMethod("PUT")
    connection.setDoOutput(true)
    connection.setRequestProperty("Content-Type", "application/json")
    connection.getOutputStream().write(data.getBytes("UTF-8"))
    if(connection.getResponseCode().equals(200)) {
        println(connection.getInputStream().getText())
    }
    return
}</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:serviceTask id="Task_bonitaetPruefen" name="Bonität prüfen" camunda:type="external" camunda:topic="bonitaetPruefen">
      <bpmn:incoming>SequenceFlow_1fljneq</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1hlkcca</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_rechnungGenerieren" name="Rechnung generieren" camunda:type="external" camunda:topic="rechnungGenerieren">
      <bpmn:incoming>Flow_0zty9hg</bpmn:incoming>
      <bpmn:outgoing>Flow_1svdc1e</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1uzjc0c" name="ja" sourceRef="XOR_LastschrifteinzugOK" targetRef="ExclusiveGateway_0g8vq52">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${lE_lastschriftEinzugOk  == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Task_lastschrifterlaubnisEinholen" name="Lastschrifterlaubnis einholen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="lE_verfuegbar" label="Ergebnis der Verfügbarkeitsprüfung:" type="string" defaultValue="${vP_verfuegbarkeit}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="lE_gesamtpreis" label="Gesamtpreis der Reise:" type="long" defaultValue="${vP_preisReiseGesamt}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="lE_lastschriftEinzugOk" label="Betrag per Lastschrift vom Konto abbuchen?" type="boolean" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0jzxq8u</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1ts5ggp</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_0ddtrac" sourceRef="Gateway_0epjd7p" targetRef="Task_zahlungsweiseAuswaehlen" />
    <bpmn:sequenceFlow id="Flow_0s35be3" name="nein" sourceRef="XOR_LastschrifteinzugOK" targetRef="Gateway_0epjd7p">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${lE_lastschriftEinzugOk  == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:exclusiveGateway id="Gateway_0epjd7p">
      <bpmn:incoming>SequenceFlow_1mkzrnu</bpmn:incoming>
      <bpmn:incoming>Flow_0s35be3</bpmn:incoming>
      <bpmn:outgoing>Flow_0ddtrac</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_kundenInformieren" name="Kunden informieren">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="kI_ratenzahlungPruefung" label="Ergebnis der Prüfung der Ratenzahlung:" type="string" defaultValue="${rP_ratenzahlungPruefung}">
            <camunda:validation>
              <camunda:constraint name="readonly" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="kI_kommentarZurRatenzahlung" label="Kommentar der Filialleitung zur Ablehnung:" type="string" defaultValue="${rP_kommentarZurRatenzahlung}" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_09jw7d1</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1mkzrnu</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0g8vq52">
      <bpmn:incoming>SequenceFlow_12zwqq9</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_01qftwm</bpmn:incoming>
      <bpmn:incoming>Flow_1uzjc0c</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0b5ref0</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_reisebuchungDurchfuehren" name="Reisebuchung durchführen">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="rD_buchungDurchfueren" label="Soll die Reisebuchung verbindlich durchführen werden? Ansonsten wird der Vorgang abgebrochen." type="boolean" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0b5ref0</bpmn:incoming>
      <bpmn:outgoing>Flow_1vmfto9</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="XOR_ReiseVerbindlichBuchen" name="Reise verbindlich buchen?">
      <bpmn:incoming>Flow_1vmfto9</bpmn:incoming>
      <bpmn:outgoing>Flow_0xzbv90</bpmn:outgoing>
      <bpmn:outgoing>Flow_16rhwpt</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:parallelGateway id="Gateway_0lwg6xz">
      <bpmn:incoming>Flow_16rhwpt</bpmn:incoming>
      <bpmn:outgoing>Flow_0zty9hg</bpmn:outgoing>
      <bpmn:outgoing>Flow_1130rds</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:parallelGateway id="Gateway_1ho2gme">
      <bpmn:incoming>Flow_1svdc1e</bpmn:incoming>
      <bpmn:incoming>Flow_00qj9j2</bpmn:incoming>
      <bpmn:outgoing>Flow_0lny208</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:userTask id="Task_unterlagenUebergeben" name="Unterlagen übergeben">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="uU_unterlagenGedruckt" label="Unterlagen gedruckt?" type="boolean" />
          <camunda:formField id="uU_unterlagenUebergeben" label="Reiseunterlagen an Kunden ausgehändigt?" type="boolean" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0lny208</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_00j2no7</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="EndEvent_buchungAbgeschlossen" name="Buchung abgeschlossen">
      <bpmn:incoming>SequenceFlow_00j2no7</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:exclusiveGateway id="XOR_LastschrifteinzugOK" name="Lastschrifteinzug ok?">
      <bpmn:incoming>SequenceFlow_1ts5ggp</bpmn:incoming>
      <bpmn:outgoing>Flow_1uzjc0c</bpmn:outgoing>
      <bpmn:outgoing>Flow_0s35be3</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:textAnnotation id="TextAnnotation_1sge9ih">
      <bpmn:text>Ab hier beginnt die lustige und aufregende Reise durch das BPMN-Universum</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1hms1y0" sourceRef="Task_bonitaetPruefen" targetRef="TextAnnotation_1sge9ih" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1fkr7nk">
      <bpmndi:BPMNShape id="Participant_0hum507_di" bpmnElement="Participant_reisebuero" isHorizontal="true">
        <dc:Bounds x="160" y="197" width="3160" height="700" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_0cfch57_di" bpmnElement="Lane_servicemitarbeiter" isHorizontal="true">
        <dc:Bounds x="190" y="197" width="3130" height="502" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_1jnl604_di" bpmnElement="Lane_filialleiter" isHorizontal="true">
        <dc:Bounds x="190" y="699" width="3130" height="198" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_16rhwpt_di" bpmnElement="Flow_16rhwpt">
        <di:waypoint x="2755" y="510" />
        <di:waypoint x="2815" y="510" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2764" y="492" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0xzbv90_di" bpmnElement="Flow_0xzbv90">
        <di:waypoint x="2730" y="485" />
        <di:waypoint x="2730" y="358" />
        <di:waypoint x="2276" y="358" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1vmfto9_di" bpmnElement="Flow_1vmfto9">
        <di:waypoint x="2670" y="510" />
        <di:waypoint x="2705" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_00qj9j2_di" bpmnElement="Flow_00qj9j2">
        <di:waypoint x="2980" y="620" />
        <di:waypoint x="3000" y="620" />
        <di:waypoint x="3000" y="535" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1130rds_di" bpmnElement="Flow_1130rds">
        <di:waypoint x="2840" y="535" />
        <di:waypoint x="2840" y="620" />
        <di:waypoint x="2880" y="620" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_00j2no7_di" bpmnElement="SequenceFlow_00j2no7">
        <di:waypoint x="3160" y="510" />
        <di:waypoint x="3215" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0lny208_di" bpmnElement="Flow_0lny208">
        <di:waypoint x="3025" y="510" />
        <di:waypoint x="3060" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1svdc1e_di" bpmnElement="Flow_1svdc1e">
        <di:waypoint x="2980" y="426" />
        <di:waypoint x="3000" y="426" />
        <di:waypoint x="3000" y="485" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0zty9hg_di" bpmnElement="Flow_0zty9hg">
        <di:waypoint x="2840" y="485" />
        <di:waypoint x="2840" y="426" />
        <di:waypoint x="2880" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_03sig6a_di" bpmnElement="Flow_03sig6a">
        <di:waypoint x="1030" y="340" />
        <di:waypoint x="1070" y="340" />
        <di:waypoint x="1070" y="401" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1lt4o01_di" bpmnElement="Flow_1lt4o01">
        <di:waypoint x="880" y="401" />
        <di:waypoint x="880" y="340" />
        <di:waypoint x="930" y="340" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="891" y="368" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1474zut_di" bpmnElement="Flow_1474zut">
        <di:waypoint x="1095" y="426" />
        <di:waypoint x="1158" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0qxhlzo_di" bpmnElement="Flow_0qxhlzo">
        <di:waypoint x="905" y="426" />
        <di:waypoint x="1045" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="965" y="408" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_02kf837_di" bpmnElement="SequenceFlow_02kf837">
        <di:waypoint x="821" y="558" />
        <di:waypoint x="955" y="558" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0dbxllw_di" bpmnElement="SequenceFlow_0dbxllw">
        <di:waypoint x="414" y="426" />
        <di:waypoint x="464" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_14bnl9k_di" bpmnElement="SequenceFlow_14bnl9k">
        <di:waypoint x="283" y="426" />
        <di:waypoint x="314" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0ghvr2o_di" bpmnElement="SequenceFlow_0ghvr2o">
        <di:waypoint x="980" y="583" />
        <di:waypoint x="980" y="659" />
        <di:waypoint x="364" y="659" />
        <di:waypoint x="364" y="466" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="671" y="663" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_059rxai_di" bpmnElement="SequenceFlow_059rxai">
        <di:waypoint x="639" y="451" />
        <di:waypoint x="639" y="558" />
        <di:waypoint x="721" y="558" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="650" y="464" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1jkbexr_di" bpmnElement="SequenceFlow_1jkbexr">
        <di:waypoint x="664" y="426" />
        <di:waypoint x="721" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="676" y="408" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1em2555_di" bpmnElement="SequenceFlow_1em2555">
        <di:waypoint x="564" y="426" />
        <di:waypoint x="614" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1omvrja_di" bpmnElement="SequenceFlow_1omvrja">
        <di:waypoint x="1183" y="451" />
        <di:waypoint x="1183" y="540" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1194" y="477" width="65" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_00vat3d_di" bpmnElement="SequenceFlow_00vat3d">
        <di:waypoint x="1005" y="558" />
        <di:waypoint x="1165" y="558" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1049" y="540" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0b5ref0_di" bpmnElement="SequenceFlow_0b5ref0">
        <di:waypoint x="2528" y="510" />
        <di:waypoint x="2570" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0gmrw1v_di" bpmnElement="SequenceFlow_0gmrw1v">
        <di:waypoint x="1896" y="807" />
        <di:waypoint x="1958" y="807" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1t55m76_di" bpmnElement="SequenceFlow_1t55m76">
        <di:waypoint x="821" y="426" />
        <di:waypoint x="855" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0ixeut4_di" bpmnElement="SequenceFlow_0ixeut4">
        <di:waypoint x="1183" y="401" />
        <di:waypoint x="1183" y="260" />
        <di:waypoint x="364" y="260" />
        <di:waypoint x="364" y="386" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1192" y="349" width="48" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1o47qu8_di" bpmnElement="SequenceFlow_1o47qu8">
        <di:waypoint x="1208" y="426" />
        <di:waypoint x="1285" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1211" y="426" width="57" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1fljneq_di" bpmnElement="SequenceFlow_1fljneq">
        <di:waypoint x="1385" y="426" />
        <di:waypoint x="1434" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1hlkcca_di" bpmnElement="SequenceFlow_1hlkcca">
        <di:waypoint x="1534" y="426" />
        <di:waypoint x="1575" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1ar5dxc_di" bpmnElement="SequenceFlow_1ar5dxc">
        <di:waypoint x="1600" y="401" />
        <di:waypoint x="1600" y="266" />
        <di:waypoint x="1673" y="266" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1570" y="366" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_030o4sl_di" bpmnElement="SequenceFlow_030o4sl">
        <di:waypoint x="1773" y="426" />
        <di:waypoint x="1821" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0p3k10m_di" bpmnElement="SequenceFlow_0p3k10m">
        <di:waypoint x="1625" y="426" />
        <di:waypoint x="1673" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1637" y="407" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1h399qt_di" bpmnElement="SequenceFlow_1h399qt">
        <di:waypoint x="1846" y="451" />
        <di:waypoint x="1846" y="767" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1856" y="473" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0n9prht_di" bpmnElement="SequenceFlow_0n9prht">
        <di:waypoint x="1871" y="426" />
        <di:waypoint x="1933" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1889" y="405" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1mz5q3s_di" bpmnElement="SequenceFlow_1mz5q3s">
        <di:waypoint x="1773" y="266" />
        <di:waypoint x="1821" y="266" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_09zsf56_di" bpmnElement="SequenceFlow_09zsf56">
        <di:waypoint x="2008" y="807" />
        <di:waypoint x="2133" y="807" />
        <di:waypoint x="2133" y="673" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2020" y="785" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_09jw7d1_di" bpmnElement="SequenceFlow_09jw7d1">
        <di:waypoint x="1983" y="782" />
        <di:waypoint x="1983" y="680" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1987" y="753" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1mkzrnu_di" bpmnElement="SequenceFlow_1mkzrnu">
        <di:waypoint x="1983" y="600" />
        <di:waypoint x="1983" y="575" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0ljyxsw_di" bpmnElement="SequenceFlow_0ljyxsw">
        <di:waypoint x="2033" y="426" />
        <di:waypoint x="2108" y="426" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1ib12rw_di" bpmnElement="SequenceFlow_1ib12rw">
        <di:waypoint x="1871" y="266" />
        <di:waypoint x="2377" y="266" />
        <di:waypoint x="2377" y="386" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1881" y="247" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_091jvlm_di" bpmnElement="SequenceFlow_091jvlm">
        <di:waypoint x="1846" y="291" />
        <di:waypoint x="1846" y="314" />
        <di:waypoint x="2258" y="314" />
        <di:waypoint x="2258" y="340" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1880" y="298" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_11bgnag_di" bpmnElement="SequenceFlow_11bgnag">
        <di:waypoint x="2133" y="401" />
        <di:waypoint x="2133" y="358" />
        <di:waypoint x="2240" y="358" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2065" y="366" width="65" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1hbqqii_di" bpmnElement="SequenceFlow_1hbqqii">
        <di:waypoint x="2158" y="426" />
        <di:waypoint x="2327" y="426" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2159" y="406" width="31" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_12zwqq9_di" bpmnElement="SequenceFlow_12zwqq9">
        <di:waypoint x="2427" y="426" />
        <di:waypoint x="2503" y="426" />
        <di:waypoint x="2503" y="485" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1ts5ggp_di" bpmnElement="SequenceFlow_1ts5ggp">
        <di:waypoint x="2330" y="633" />
        <di:waypoint x="2385" y="633" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_01qftwm_di" bpmnElement="SequenceFlow_01qftwm">
        <di:waypoint x="2133" y="451" />
        <di:waypoint x="2133" y="510" />
        <di:waypoint x="2478" y="510" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2091" y="483" width="37" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0jzxq8u_di" bpmnElement="SequenceFlow_0jzxq8u">
        <di:waypoint x="2183" y="633" />
        <di:waypoint x="2230" y="633" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1uzjc0c_di" bpmnElement="Flow_1uzjc0c">
        <di:waypoint x="2435" y="633" />
        <di:waypoint x="2503" y="633" />
        <di:waypoint x="2503" y="535" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2516" y="612" width="8" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ddtrac_di" bpmnElement="Flow_0ddtrac">
        <di:waypoint x="1983" y="525" />
        <di:waypoint x="1983" y="466" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0s35be3_di" bpmnElement="Flow_0s35be3">
        <di:waypoint x="2410" y="608" />
        <di:waypoint x="2410" y="550" />
        <di:waypoint x="2008" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2415" y="576" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ExclusiveGateway_1r1mp9i_di" bpmnElement="XOR_bonitaetVorhanden" isMarkerVisible="true">
        <dc:Bounds x="1575" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1572" y="461" width="58" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0fn95et_di" bpmnElement="Task_ratenzahlungAnbieten">
        <dc:Bounds x="1673" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_1vzvrge_di" bpmnElement="XOR_ratenzahlungZugestimmt" isMarkerVisible="true">
        <dc:Bounds x="1821" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1814" y="376" width="68" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0eiy8fn_di" bpmnElement="Task_sofortzahlungAnbieten">
        <dc:Bounds x="1673" y="226" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0jv2kj3_di" bpmnElement="XOR_sofortzahlungZugestimmt" isMarkerVisible="true">
        <dc:Bounds x="1821" y="241" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1814" y="217" width="68" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0louat6_di" bpmnElement="XOR_ratenzahlungGenehmigt" isMarkerVisible="true">
        <dc:Bounds x="1958" y="782" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1949" y="842" width="68" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0bz1in2_di" bpmnElement="Task_zahlungsweiseAuswaehlen">
        <dc:Bounds x="1933" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1x58ef7_di" bpmnElement="Task_ratenzahlungPruefen">
        <dc:Bounds x="1796" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_12g2xw6_di" bpmnElement="XOR_angebotZugestimmt" isMarkerVisible="true">
        <dc:Bounds x="1158" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1103" y="442" width="62" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1vzv0bw_di" bpmnElement="XOR_ZahlungsweiseAusgewaehlt" isMarkerVisible="true">
        <dc:Bounds x="2108" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2050" y="436" width="73" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1944dty_di" bpmnElement="EndEvent_buchungAbgebrochen">
        <dc:Bounds x="1165" y="540" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1151" y="583" width="65" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_0srjfvg_di" bpmnElement="EndEvent_buchungAbgebrochen2">
        <dc:Bounds x="2240" y="340" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2226" y="383" width="65" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0v5moj0_di" bpmnElement="Task_kundendatenAufnehmen">
        <dc:Bounds x="1285" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0gy7xxk_di" bpmnElement="Task_sofortzahlungDurchfuehren">
        <dc:Bounds x="2327" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_1drkshf_di" bpmnElement="Task_bankdatenEinholen">
        <dc:Bounds x="2083" y="593" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_1249udf_di" bpmnElement="XOR_kundenwunschVerfuegbar" isMarkerVisible="true">
        <dc:Bounds x="614" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="601" y="364" width="76" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_14pdan0_di" bpmnElement="Task_kundenwunschErfassen">
        <dc:Bounds x="314" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_120u5yz_di" bpmnElement="Task_verfuegbarkeitenPruefen">
        <dc:Bounds x="464" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_02tq31b_di" bpmnElement="Task_angebotAuswaehlen">
        <dc:Bounds x="721" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_buchungswunschLiegtVor">
        <dc:Bounds x="247" y="408" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="222" y="451" width="87" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1nub4bv_di" bpmnElement="Gateway_1nub4bv" isMarkerVisible="true">
        <dc:Bounds x="855" y="401" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="851" y="458" width="59" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0zjevc8_di" bpmnElement="Gateway_0zjevc8" isMarkerVisible="true">
        <dc:Bounds x="1045" y="401" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0zjzoos_di" bpmnElement="XOR_kundenwunschAnpassen" isMarkerVisible="true">
        <dc:Bounds x="955" y="533" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="942" y="502" width="76" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_05quikx_di" bpmnElement="Task_problemBesprechen">
        <dc:Bounds x="721" y="518" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1lrvl6f_di" bpmnElement="Activity_0dy0a97">
        <dc:Bounds x="930" y="300" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0avd179_di" bpmnElement="Activity_16mvpmg">
        <dc:Bounds x="2880" y="580" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0yfqzg4_di" bpmnElement="Task_bonitaetPruefen">
        <dc:Bounds x="1434" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0pom3bj_di" bpmnElement="Task_rechnungGenerieren">
        <dc:Bounds x="2880" y="386" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_1sge9ih_di" bpmnElement="TextAnnotation_1sge9ih">
        <dc:Bounds x="1434" y="266" width="100" height="96" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_0px80hz_di" bpmnElement="Task_lastschrifterlaubnisEinholen">
        <dc:Bounds x="2230" y="593" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0epjd7p_di" bpmnElement="Gateway_0epjd7p" isMarkerVisible="true">
        <dc:Bounds x="1958" y="525" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_16ij1i5_di" bpmnElement="Task_kundenInformieren">
        <dc:Bounds x="1933" y="600" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0g8vq52_di" bpmnElement="ExclusiveGateway_0g8vq52" isMarkerVisible="true">
        <dc:Bounds x="2478" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_12dva4v_di" bpmnElement="Task_reisebuchungDurchfuehren">
        <dc:Bounds x="2570" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0q8jon0_di" bpmnElement="XOR_ReiseVerbindlichBuchen" isMarkerVisible="true">
        <dc:Bounds x="2705" y="485" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2688" y="542" width="84" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1vgz8wa_di" bpmnElement="Gateway_0lwg6xz">
        <dc:Bounds x="2815" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0xt8jco_di" bpmnElement="Gateway_1ho2gme">
        <dc:Bounds x="2975" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_18npl2a_di" bpmnElement="Task_unterlagenUebergeben">
        <dc:Bounds x="3060" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1kflstd_di" bpmnElement="EndEvent_buchungAbgeschlossen">
        <dc:Bounds x="3215" y="492" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3196" y="535" width="74" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_13iw6cv_di" bpmnElement="XOR_LastschrifteinzugOK" isMarkerVisible="true">
        <dc:Bounds x="2385" y="608" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2369" y="665" width="83" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Association_1hms1y0_di" bpmnElement="Association_1hms1y0">
        <di:waypoint x="1484" y="386" />
        <di:waypoint x="1484" y="362" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Participant_08zldhw_di" bpmnElement="Participant_kunde" isHorizontal="true">
        <dc:Bounds x="160" y="97" width="3160" height="60" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
